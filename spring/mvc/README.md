# Spring MVC

* [DispatcherServlet](#DispatcherServlet)
* [Controller](#Controller)
* [HTTP](#HTTP)
* [Model](#Model)
* [View](#View)

Предполагает разработку web-приложений с использованием архитектуры Model - View - Controller.



## MVC | Model - View - Controller

- `Model` - логика работы с данными (обращение к БД)
- `View` - логика представления, интерфейс
- `Controller` - логика навигации, обработки запросов

<a name = "DispatcherServlet"></a>

---

## DispatcherServlet

Входная точка Spring MVC приложения. Находится между `Controller`
и `HTTP Request`

HTTP запрос от пользователя:
1. Приходит на сервер. Сервер обрабатывает запрос и передает
его на Spring MVC приложение.
2. Запрос попадает в DispatcherServlet.
3. DispatcherServlet отправляет запрос на правильный контроллер.

<a name = "Controller"></a>

---

## Controller

- `@Controller`
- Обрабатывает запросы от пользователя
- Обменивается данными с моделью
- Показывает пользователю правильное представление
- Переадресовывает пользователя на другие страницы

`@Controller` - тот же `@Component`, но с дополнительными возможностями.
В контроллере может быть несколько методов, которые возвращают строки - названия представлений, которые нужно показать
пользователю. Обычно каждый метод соответствует одному URL'у 

### Маппинги

Связывают метод контроллера с адресом, по которому к этому можно к этому методу обратиться (из браузера, например)

```java
@Controller
public class HelloController {
    @GetMapping("/hello-world")
    public String sayHello() {return "hello_world"; }
}
```


#### @RequestMapping

Используется для того, чтобы указать, что **ВСЕ МЕТОДЫ** класса в начале адреса имели префикс

```java
@Controller
@RequestMapping("/people"
public class PersonController {
    @GetMapping("/new") // обрабатывает запросы /people/new
    public String new() { return "new"; }

      @GetMapping("/old") // обрабатывает запросы /people/old
      public String old() { return "old"; }
}
```

### HTTP

<a name = "HTTP"></a>

#### HTTP-Запросы

| HTTP метод | Аннотация      | Описание                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|------------|----------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| GET        | @GetMapping    | Самый используемый запрос. Получение данных с удаленного сервера (переход по адресу, ссылке, поисковой запрос и т.д.). Ничего не меняет на сервере<br/><br/> Параметры нужны для передачи информации от клиента серверу во время запроса. Передаются в самом URL после знака **?** в формате **ключ=значение**. Несколько параметров разделяются знаком **&**.<br/> <br/>https://vk.com/audios202613076?q=lilpeep&section=playlist Параметры (**?q=lilpeep&section=playlist**) |
| POST       | @PostMapping   | Добавить на сервер (отправка данных с веб-форм, создать учетную запись, твитнуть, загрузить фото, добавить запись в сообщество). Параметры закодированы в теле запроса.                                                                                                                                                                                                                                                                                                        |
| PUT        | @PutMapping    | Создаёт новый ресурс или заменяет представление целевого ресурса, данными представленными в теле запроса                                                                                                                                                                                                                                                                                                                                                                       |
| DELETE     | @DeleteMapping | Удаляет указанный ресурс                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| PATCH      | @PatchMapping  | Частично изменяет ресурс                                                                                                                                                                                                                                                                                                                                                                                                                                                       |

#### HTTP-Ответы

* 200 - все ОК
* 3хх - редирект
* 4хх - ошибка клиента (404 - клиент пытается попасть на несущестующую страницу)
* 5хх - ошибка сервера (502: Bad Gateway -  сервер не смог обработать полученный запрос по техническим причинам)

---

<a name = "Model"></a>


## Model

 - Хранит в себе данные
 - Взаимодействует с бд для получения данных
 - Отдает данные контроллеру

<a name = "View"></a>

---
## View

- Получает данные от контроллера и отображает их в браузере
- Для динамического отображения данных используются шаблонизаторы
  (`Thymeleaf`, `Freemaker`, `Velocity`)